namespace = equus

########################JOINING############################

#From on_character_ask_to_join_society
character_event = {
    id = equus.100
	hide_window = yes
    is_triggered_only = yes
    trigger = {
		OR = {
			FROM = { leader = { society_member_of = military_knights } }
			FROM = { leader = { society_member_of = military_knights1 } }
			FROM = { leader = { society_member_of = military_knights2 } }
			FROM = { leader = { society_member_of = diplomatic_knights } }
			FROM = { leader = { society_member_of = diplomatic_knights1 } }
			FROM = { leader = { society_member_of = diplomatic_knights2 } }
		}
    }
    immediate = {
    	FROM = { leader = { character_event = { id = equus.101 } } } #target is the leader of the society
    }
}

#Ping event
character_event = {
    id = equus.101
	hide_window = yes
    is_triggered_only = yes
    immediate = {
    	FROM = { letter_event = { id = equus.102 } } #send event back 
    }
}

#Welcome letter
letter_event = {
    id = equus.102
    desc = EVTDESC_equus.102
    border = GFX_event_letter_frame_war
	
    is_triggered_only = yes

    option = { #join the society
        name = EVTOPTA_equus.102
		if = {
			limit = {
				FROM = { society_member_of = military_knights }
			}
			join_society = military_knights
		}
		if = {
			limit = {
				FROM = { society_member_of = military_knights1 }
			}
			join_society = military_knights1
		}
		if = {
			limit = {
				FROM = { society_member_of = military_knights2 }
			}
			join_society = military_knights2
		}
		if = {
			limit = {
				FROM = { society_member_of = diplomatic_knights }
			}
			join_society = diplomatic_knights
		}
		if = {
			limit = {
				FROM = { society_member_of = diplomatic_knights1 }
			}
			join_society = diplomatic_knights1
		}
		if = {
			limit = {
				FROM = { society_member_of = diplomatic_knights2 }
			}
			join_society = diplomatic_knights2
		}
    }
}

########################AI JOIN AND AI RANK UP###########################

character_event = { #force the AI to join a society
	id = equus.110
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { #if he's already a member, will force a rank up 25% of the time
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				OR = {
					society_member_of = military_knights
					society_member_of = military_knights1
					society_member_of = military_knights2
					society_member_of = diplomatic_knights
					society_member_of = diplomatic_knights1
					society_member_of = diplomatic_knights2
				}
				society_rank <= 2
				society_can_rank_up = yes
			}
			random_list = {
				90 = {}
				10 = {
					society_rank_up = 1					
				}
			}
		}
		any_courtier = {  #if you want courtier in the society enable this part
			limit = {
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				is_adult = yes
				is_in_society = no
				controls_religion = no
				block_general_event_trigger = no
			}
			character_event = { id = equus.111 }
		}
		if = { #force the joining event on AI
			limit = {
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				is_adult = yes
				is_in_society = no
				controls_religion = no
				block_general_event_trigger = no
			}
			character_event = { id = equus.111 }
		}
	}
}

character_event = { #AI join event
	id = equus.111
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			50 = { # do nothing
			}
			50 = { 
				modifier = { #meet the requirement
					factor = 0
					AND = {
						NOT = { can_join_society = military_knights }
						NOT = { can_join_society = military_knights1 }
						NOT = { can_join_society = military_knights2 }
						NOT = { can_join_society = diplomatic_knights }
						NOT = { can_join_society = diplomatic_knights1 }
						NOT = { can_join_society = diplomatic_knights2 }
					}
				}
				random_list = {
					1 = {}
					10 = {
						if = {
							limit = {
								can_join_society = military_knights
								has_global_flag = military_knights_exist
								NOT = { has_global_flag = military_knights_noauto }
								NOT = {
									is_society_rank_full = {
										society = military_knights
										rank = 1
									}
								}
							}
							join_society = military_knights
						}
					}
					10 = {
						if = {
							limit = {
								can_join_society = military_knights1
								has_global_flag = military_knights1_exist
								NOT = { has_global_flag = military_knights1_noauto }
								NOT = {
									is_society_rank_full = {
										society = military_knights1
										rank = 1
									}
								}
							}
							join_society = military_knights1
						}
					}
					10 = {
						if = {
							limit = {
								can_join_society = military_knights2
								has_global_flag = military_knights2_exist
								NOT = { has_global_flag = military_knights2_noauto }
								NOT = {
									is_society_rank_full = {
										society = military_knights2
										rank = 1
									}
								}
							}
							join_society = military_knights2
						}
					}
					10 = {
						if = {
							limit = {
								can_join_society = diplomatic_knights
								has_global_flag = diplomatic_knights_exist
								NOT = { has_global_flag = diplomatic_knights_noauto }
								NOT = {
									is_society_rank_full = {
										society = diplomatic_knights
										rank = 1
									}
								}
							}
							join_society = diplomatic_knights
						}
					}
					10 = {
						if = {
							limit = {
								can_join_society = diplomatic_knights1
								has_global_flag = diplomatic_knights1_exist
								NOT = { has_global_flag = diplomatic_knights1_noauto }
								NOT = {
									is_society_rank_full = {
										society = diplomatic_knights1
										rank = 1
									}
								}
							}
							join_society = diplomatic_knights1
						}
					}
					10 = {
						if = {
							limit = {
								can_join_society = diplomatic_knights2
								has_global_flag = diplomatic_knights2_exist
								NOT = { has_global_flag = diplomatic_knights2_noauto }
								NOT = {
									is_society_rank_full = {
										society = diplomatic_knights2
										rank = 1
									}
								}
							}
							join_society = diplomatic_knights2
						}
					}
				}	
				
				random_list = { # Artificially increase society influence for balance purposes
					75 = {
						modifier = {
							factor = 0
							society_influence >= 30
						}
						add_mission_succeed_influence_effect = yes #complete a fake mission for AI
					}
					25 = {
					}
				}
				if = { # Make grandmaster is there is none
					limit = {
						NOT = {
							society = {
								any_society_member = {
									is_society_grandmaster = yes
								}
							}
						}
					}
					set_society_grandmaster = yes
				}
			}
		}
	}
}

#######################Rank UP#############################

# Hidden start: Send the rank-up request to the current Grandmaster (delayed event on self, from decision to rank up)
character_event = {
	id = equus.120

	hide_window = yes

	trigger = { #has pressed the button
		has_character_flag = has_sent_request_to_rank_up
	}
	
	is_triggered_only = yes

	immediate = {
		if = { #if he's still a member
			limit = { is_in_society = yes }
			random_society_member = { #will send the request to a random top rank member of the same society
				limit = {
					is_society_grandmaster = yes
					same_society_as = ROOT
				}
				character_event = { id = equus.121 } # send request to Grand Master.
			}
		}
		if = { #if he's not a member
			limit = { is_in_society = no }
			clr_character_flag = has_sent_request_to_rank_up
		}
	}
}

# Grandmaster gets the rank-up request
character_event = {
	id = equus.121
	
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		event_target:rank_up_target = { letter_event = { id = equus.122 } } #send it back
	}
}

#Grand master approves my request
letter_event = {
	id = equus.122
	desc = EVTDESC_equus.122
	border = GFX_event_letter_frame_war

	trigger = {
		society_rank < 4 #cannot rank up past 4
		has_character_flag = has_sent_request_to_rank_up
	}
	
	is_triggered_only = yes

	#Rank up approved
	option = {
		name = EVTOPTA_equus.122
		if = { limit = { society_rank < 4 } #if not max rank, rank up
			society_rank_up = 1
		}
		clr_character_flag = has_sent_request_to_rank_up
	}
}

#################################MISSIONS######################################

#Mission tombola, this is where an hidden event choose a quest. I have made only one quest, do look for other mission tombola in the vanilla files for more example.
character_event = {
    id = equus.130
    hide_window = yes

    is_triggered_only = yes
    
	is_in_society = yes

	trigger = {
		OR = {
			society_member_of = military_knights
			society_member_of = military_knights1
			society_member_of = military_knights2
		}
		has_any_quest = no #cannot have more than 1 shown
		NOT = { has_character_modifier = quest_cooldown_timer } #to avoid spam and delay it for people who refused a quest.
		NOT = { is_inaccessible_trigger = yes }
		prisoner = no
		society = { #look if there is a close member to give you the quest
			any_society_member = {
				NOT = { character = ROOT }
				prisoner = no
				is_within_diplo_range = ROOT
				opinion = { who = ROOT value = 0 }
			}
		}
	}

    immediate = {
    	#Picks out mission giver
    	random_list = {
    		20 = { #International society member
    			society = {
    				random_society_member = {
    					limit = { 	
							NOT = { character = ROOT }
							prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
    					}
    					save_event_target_as = quest_collaborator
    				}
    			}
    		}
    		40 = { #Realm society member is there is any
    			trigger = {
    				society = {
    					any_society_member = {
    						NOT = { character = ROOT }
    						prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
							same_realm = ROOT
    					}
    				}
    			}
    			society = {
    				random_society_member = {
    					limit = { 	
    						NOT = { character = ROOT }
    						prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
							same_realm = ROOT
    					}
    					save_event_target_as = quest_collaborator
    				}
    			}
    		}
    	}

    	#Randomizes mission
		random_list = {
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = bandit_quest
				}
				character_event = { id = equus.140 days = 14 random = 7 } #Fight famous bandit
			}
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = beast_quest
				}
				character_event = { id = equus.145 days = 14 random = 7 } #Slay beast
			}
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = pilgrim_quest
				}
				character_event = { id = equus.150 days = 14 random = 7 } #Escort pilgrims
			}
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = training_quest
				}
				event_target:quest_collaborator = { character_event = { id = equus.160 days = 14 random = 7 } } #Improve military skill
			}
			
			50 = { # AI bypasses missions at times and goes directly to success/failure, increase the 50 if you add more mission or you could delete this whole { }.
				modifier = {
					factor = 0
					ai = no
				}
				random_list = {
					70 = { #success, harder the more influencial the society is
						modifier = {
							factor = 0.9
							society_influence >= 30
						}
						modifier = {
							factor = 0.9
							society_influence >= 40
						}
						modifier = {
							factor = 0.8
							society_influence >= 50
						}
						modifier = {
							factor = 0.7
							society_influence >= 70
						}
						modifier = {
							factor = 0.6
							society_influence >= 80
						}
						modifier = {
							factor = 0.5
							society_influence >= 90
						}
						add_mission_succeed_influence_effect = yes
					}
					30 = { #failure
						add_mission_fail_influence_effect = yes
					}
				}
			}
			
			100 = { #AI refuse mission
				modifier = {
					factor = 0
					ai = no
				}
			}
    	}
    }
}

#Bandit

#Accept or refuse quest event
society_quest_event = {
    id = equus.140
    desc = EVTDESC_equus.140

    is_triggered_only = yes
   
    option = { 
		name = ACCEPT
		set_quest = military_knights_quest_bandit #use this if the quest has no real target, look at other quests made by Paradox if you want something more complicated that target someone/something
		character_event = { id = equus.141 days = 14 random = 7 }
		clr_character_flag = training_quest
		clr_character_flag = pilgrim_quest
		clr_character_flag = beast_quest
		set_character_flag = bandit_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#Event chain start (how to get there)
character_event = {
    id = equus.141
    desc = EVTDESC_equus.141
    picture = GFX_evt_throne_room
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.142 days = 14 random = 7 }
		set_variable = { which = "bandit_success" value = 0 }
	}

    option = { 
        name = EVTOPTA_equus.141 #Talk for information
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					set_character_flag = bandit_success
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
					modifier = {
						factor = 1.33
						trait = charitable
					}
				}
				50 = {
					set_character_flag = bandit_failure #Failure
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.141 #Go in search
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					set_character_flag = bandit_success
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						martial = 20
					}
				}
				50 = {
					set_character_flag = bandit_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.141 #Ambush
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					set_character_flag = bandit_success
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
				}
				25 = {
					set_character_flag = bandit_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.141 #Threaten their friends
		trigger = {
			trait = cruel
		}
		tooltip_info = cruel
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					set_character_flag = bandit_success
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						martial = 20
					}
					modifier = {
						factor = 1.33
						martial = 25
					}
				}
				25 = {
					set_character_flag = bandit_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = stubborn
					}
					modifier = {
						factor = 1.33
						NOT = { martial = 10 }
					}
				}
			}
		}
    }
}

#Bandit issue challenge/Find bandit lair (How do you prepare?)
character_event = {
    id = equus.142
    desc = {
		trigger = {
			has_character_flag = bandit_success 
		}
		text = EVTDESC_equus.142s
	}
	desc = {
		trigger = {
			has_character_flag = bandit_failure 
		}
		text = EVTDESC_equus.142f
	}
    picture = "GFX_evt_bandits"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.143 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.142 #Sparring
		random_list = {
			50 = {
				
			}
			40 = {
				add_one_duel_experience_modifier = yes
			}
			10 = {
				add_trait = brave
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						martial = 20
					}
					modifier = {
						factor = 1.33
						martial = 25
					}
				}
				50 = { #Failure
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						NOT = { martial = 10 }
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.142 #Pray for guidance
		random_list = {
			50 = {
				
			}
			40 = {
				change_learning = 1
			}
			10 = {
				add_trait = zealous
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = chaste
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						learning = 15
					}
					modifier = {
						factor = 1.33
						learning = 20
					}
				}
				50 = { #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						NOT = { learning = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { learning = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.142 #Poison weapons
		random_list = {
			50 = {
				
			}
			40 = {
				change_intrigue = 1
			}
			10 = {
				add_trait = deceitful
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
				}
				50 = { #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.142 #Train squire
		random_list = {
			50 = {
				
			}
			40 = {
				random_courtier = {
					limit = {
						has_minor_title = title_knight_squire
					}
					add_one_duel_experience_modifier = yes
				}
				add_one_duel_experience_modifier = yes
			}
			10 = {
				random_courtier = {
					limit = {
						has_minor_title = title_knight_squire
					}
					add_trait = brave
				}
			}
		}
		hidden_tooltip = {
			random_courtier = {
				limit = {
					has_minor_title = title_knight_squire
				}
				random_list = {
					60 = {
						ROOT = { 
							change_variable = { which = "bandit_success" value = 1 }  #Success
						}
						modifier = {
							factor = 1.33
							trait = patient
						}
						modifier = {
							factor = 1.33
							trait = wroth
						}
						modifier = {
							factor = 1.33
							trait = brave
						}
						modifier = {
							factor = 1.33
							trait = diligent
						}
						modifier = {
							factor = 1.33
							martial = 20
						}
						modifier = {
							factor = 1.33
							martial = 25
						}
					}
					40 = { #Failure
						modifier = {
							factor = 1.33
							trait = craven
						}
						modifier = {
							factor = 1.33
							NOT = { martial = 10 }
						}
					}
				}
			}
		}
    }
}

#Duel bandit lord
character_event = {
    id = equus.143
    
    picture = "GFX_evt_bandits"
    border = GFX_event_normal_frame_war
	desc = EVTDESC_equus.143
    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.144 days = 14 random = 7 }
		clr_character_flag = bandit_success
		clr_character_flag = bandit_failure
	}

    option = { 
        name = EVTOPTA_equus.143 #Duel honorably
		random_list = {
			50 = {
				
			}
			40 = {
				change_diplomacy = 1
			}
			10 = {
				add_trait = honest
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = { #Failure
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = trusting
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 30 }
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.143 #Fight dirty
		random_list = {
			50 = {
				
			}
			40 = {
				change_intrigue = 1
			}
			10 = {
				add_trait = deceitful
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				40 = { #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 30 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.143 #Let your squire take the lead
		prestige = -50
		hidden_tooltip = { #Injury
			random_list = {
				50 = {
					
				}
				40 = {
					random_courtier = {
						limit = {
							has_minor_title = title_knight_squire
						}
						add_trait = wounded
					}
				}
				10 = {
					random_courtier = {
						limit = {
							has_minor_title = title_knight_squire
						}
						if = {
							limit = { has_dlc = "Reapers" }
							add_trait = severely_injured
							resolve_severely_injured_effect = yes
							random_list = {
								63 = {
									add_trait = one_eyed
								}
								20 = {
									add_trait = one_legged
								}
								18 = {
									add_trait = one_handed
								}
								16 = {
									add_trait = blinded
								}
								15 = {
									add_trait = disfigured
								}
								7 = {
									add_trait = mangled
								}
							}
						}
						if = {
							limit = { NOT = { has_dlc = "Reapers" }}
							add_trait = maimed
						}
					}
				}
			}
		}
		hidden_tooltip = { #Success or not
			random_list = {
				50 = {
					change_variable = { which = "bandit_success" value = 1 }  #Success
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = patient
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = wroth
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = brave
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = diligent
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							combat_rating = 40
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							combat_rating = 50
						}
					}
				}
				50 = { #Failure
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = craven
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = trusting
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							NOT = { combat_rating = 20 }
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							NOT = { combat_rating = 10 }
						}
					}
				}
			}
		}
    }
}


#Bandit resolution
character_event = {
    id = equus.144
    desc = {
		trigger = {
			is_variable_equal = { which = "bandit_success" value = 3 } #Healthy win
		}
		text = EVTDESC_equus.144hw
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "bandit_success" value = 2 } #Injured win
		}
		text = EVTDESC_equus.144iw
	}
	desc = {
		trigger = {
			OR = {
				is_variable_equal = { which = "bandit_success" value = 1 } #Injured loss
				is_variable_equal = { which = "bandit_success" value = 0 } 
			}
		}
		text = EVTDESC_equus.144il
	}
    picture = "GFX_evt_bandits"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		clr_character_flag = bandit_success
		clr_character_flag = bandit_failure
		if = {
			limit = {
				NOT = { is_variable_equal = { which = "bandit_success" value = 3 }}
			}
			random_list = {
				10 = {
					add_trait = wounded
					modifier = {
						factor = 9
						is_variable_equal = { which = "bandit_success" value = 2 }
					}
					modifier = {
						factor = 3
						is_variable_equal = { which = "bandit_success" value = 1 }
					}
				}
				10 = {
					if = {
						limit = { has_dlc = "Reapers" }
						add_trait = severely_injured
						resolve_severely_injured_effect = yes
						random_list = {
							63 = {
								add_trait = one_eyed
							}
							20 = {
								add_trait = one_legged
							}
							18 = {
								add_trait = one_handed
							}
							16 = {
								add_trait = blinded
							}
							15 = {
								add_trait = disfigured
							}
							7 = {
								add_trait = mangled
							}
						}
					}
					if = {
						limit = { NOT = { has_dlc = "Reapers" }}
						add_trait = maimed
					}
				}
			}
		}
	}

    option = { 
        name = EVTOPTA_equus.144 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "bandit_success" value = 3 }
				is_variable_equal = { which = "bandit_success" value = 2 }
			}
		}
		clr_quest = military_knights_quest_bandit #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
		add_one_duel_experience_modifier = yes
    }
	option = {
        name = EVTOPTB_equus.144 #Loss
		trigger = {
			OR = {
				is_variable_equal = { which = "bandit_success" value = 1 }
				is_variable_equal = { which = "bandit_success" value = 0 }
			}
		}
		clr_quest = military_knights_quest_bandit #remove the quest
		add_mission_fail_influence_effect = yes #quest remove society influence
		change_society_currency = -100 
    }
}


#Beast

#Accept or refuse quest event
society_quest_event = {
    id = equus.145
    desc = EVTDESC_equus.145

    is_triggered_only = yes
   
    immediate = {
		random_list = {
			10 = {
				set_character_flag = boar_hunt
			}
			10 = {
				set_character_flag = bear_hunt
				modifier = {
					capital_scope = { region = world_africa }
					factor = 0
				}
			}
			10 = {
				set_character_flag = wolf_hunt
				modifier = {
					capital_scope = { region = world_africa }
					factor = 0
				}
			}
			10 = {
				set_character_flag = lion_hunt
				modifier = {
					OR = {
						capital_scope = { region = world_europe }
						capital_scope = { region = world_steppe }
						capital_scope = { region = world_himalayas }
					}
					factor = 0
				}
			}
			10 = {
				set_character_flag = bull_hunt
			}
			1000 = {
				set_character_flag = rabbit_hunt
				modifier = {
					NOT = { trait = lunatic }
					factor = 0
				}
			}
		}	
	}
   
    option = { 
		name = ACCEPT
		set_quest = military_knights_quest_beast #use this if the quest has no real target, look at other quests made by Paradox if you want something more complicated that target someone/something
		character_event = { id = equus.146 days = 14 random = 7 }
		clr_character_flag = training_quest
		clr_character_flag = pilgrim_quest
		set_character_flag = beast_quest
		clr_character_flag = bandit_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#Event chain start (how to find beast)
character_event = {
    id = equus.146
    desc = EVTDESC_equus.146
    picture = "GFX_evt_rider_adventure"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.147 days = 14 random = 7 }
		set_variable = { which = "beast_success" value = 0 }
	}

    option = { 
        name = EVTOPTA_equus.146 #Track
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						stewardship = 20
					}
					modifier = {
						factor = 1.33
						stewardship = 15
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = hunter
					}
				}
				50 = {
					set_character_flag = beast_failure #Failure
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						NOT = { stewardship = 5 }
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.146 #Bait
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = hunter
					}
				}
				50 = {
					set_character_flag = beast_failure #Failure
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.146 #Poisoned bait(gives 2-1-0)
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			random_list = {
				25 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = master_schemer
					}
				}
			50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					modifier = {
						factor = 1.33
						NOT = { intrigue = 15 }
					}
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = master_schemer
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
				}
				25 = {
					set_character_flag = beast_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.146 #Trap for injury(gives 2-1-0)
		trigger = {
			trait = cruel
		}
		tooltip_info = cruel
		hidden_tooltip = {
			random_list = {
				25 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					modifier = {
						factor = 1.33
						stewardship = 10
					}
					modifier = {
						factor = 1.33
						stewardship = 15
					}
					modifier = {
						factor = 1.33
						stewardship = 20
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = architect
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
				}
			50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					modifier = {
						factor = 1.33
						NOT = { stewardship = 10 }
					}
					modifier = {
						factor = 1.33
						stewardship = 10
					}
					modifier = {
						factor = 1.33
						stewardship = 15
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = master_schemer
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
				}
				25 = {
					set_character_flag = beast_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						NOT = { stewardship = 5 }
					}
				}
			}
		}
    }
}

#Find beast (more or less easily) and first attack
character_event = {
    id = equus.147
    desc = {
		trigger = {
			has_character_flag = beast_success 
		}
		text = EVTDESC_equus.147s
	}
	desc = {
		trigger = {
			has_character_flag = beast_failure 
		}
		text = EVTDESC_equus.147f
	}
    picture = "GFX_evt_mysterious_forest"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.148 days = 1 }
	}

    option = { 
        name = EVTOPTA_equus.147 #Ranged
		hidden_tooltip = {
			random_list = {
				30 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						has_character_flag = bull_hunt
					}
					modifier = {
						factor = 1.33
						has_character_flag = lion_hunt
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
				}
				20 = {
					set_character_flag = beast_failure #Failure
					clr_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.147 #Sword
		hidden_tooltip = {
			random_list = {
				20 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
				}
				30 = {
					set_character_flag = beast_failure #Failure
					clr_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.147 #Spear
		hidden_tooltip = {
			random_list = {
				25 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						has_character_flag = bear_hunt
					}
					modifier = {
						factor = 1.33
						has_character_flag = boar_hunt
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
				}
				25 = {
					set_character_flag = beast_failure #Failure
					clr_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.147 #Send squire ahead
		prestige = -50
		hidden_tooltip = {
			random_courtier = {
				limit = {
					has_minor_title = title_knight_squire
				}
				random_list = { #Injury
					50 = {
						
					}
					40 = {
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							add_trait = wounded
						}
					}
					10 = {
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							if = {
								limit = { has_dlc = "Reapers" }
								add_trait = severely_injured
								resolve_severely_injured_effect = yes
								random_list = {
									63 = {
										add_trait = one_eyed
									}
									20 = {
										add_trait = one_legged
									}
									18 = {
										add_trait = one_handed
									}
									16 = {
										add_trait = blinded
									}
									15 = {
										add_trait = disfigured
									}
									7 = {
										add_trait = mangled
									}
								}
							}
							if = {
								limit = { NOT = { has_dlc = "Reapers" }}
								add_trait = maimed
							}
						}
					}
				}
				random_list = {
					60 = {
						ROOT = { 
							change_variable = { which = "beast_success" value = 1 }  #Success
							set_character_flag = beast_success
							clr_character_flag = beast_failure
						}
						modifier = {
							factor = 1.33
							trait = patient
						}
						modifier = {
							factor = 1.33
							trait = wroth
						}
						modifier = {
							factor = 1.33
							trait = brave
						}
						modifier = {
							factor = 1.33
							trait = diligent
						}
						modifier = {
							factor = 1.33
							combat_rating = 40
						}
						modifier = {
							factor = 1.33
							combat_rating = 50
						}
					}
					40 = {
						ROOT = { #Failure
							set_character_flag = beast_failure
							clr_character_flag = beast_success
						} 
						modifier = {
							factor = 1.33
							trait = craven
						}
						modifier = {
							factor = 1.33
							NOT = { combat_rating = 20 }
						}
					}
				}
			}
		}
    }
}

#Second attack
character_event = {
    id = equus.148
    desc = {
		trigger = {
			has_character_flag = beast_success 
		}
		text = EVTDESC_equus.148s
	}
	desc = {
		trigger = {
			has_character_flag = beast_failure 
		}
		text = EVTDESC_equus.148f
	}
    picture = "GFX_evt_mysterious_forest"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.149 days = 1 }
	}

    option = { 
        name = EVTOPTA_equus.148 #Ranged
		hidden_tooltip = {
			random_list = {
				30 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
				}
				20 = {
					set_character_flag = beast_failure #Failure
					clr_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.148 #Sword
		hidden_tooltip = {
			random_list = {
				20 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						has_character_flag = bull_hunt
					}
					modifier = {
						factor = 1.33
						has_character_flag = lion_hunt
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						martial = 20
					}
					modifier = {
						factor = 1.33
						martial = 25
					}
				}
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
				}
				30 = {
					set_character_flag = beast_failure #Failure
					clr_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.148 #Spear
		hidden_tooltip = {
			random_list = {
				25 = {
					change_variable = { which = "beast_success" value = 2 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						has_character_flag = bear_hunt
					}
					modifier = {
						factor = 1.33
						has_character_flag = boar_hunt
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					change_variable = { which = "beast_success" value = 1 }  #Success
					set_character_flag = beast_success
					clr_character_flag = beast_failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
				}
				25 = {
					set_character_flag = beast_failure #Failure
					clr_character_flag = beast_success
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						NOT = { combat_rating = 20 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.148 #Send squire ahead
		prestige = -50
		hidden_tooltip = {
			random_courtier = {
				limit = {
					has_minor_title = title_knight_squire
				}
				random_list = { #Injury
					50 = {
						
					}
					40 = {
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							add_trait = wounded
						}
					}
					10 = {
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							if = {
								limit = { has_dlc = "Reapers" }
								add_trait = severely_injured
								resolve_severely_injured_effect = yes
								random_list = {
									63 = {
										add_trait = one_eyed
									}
									20 = {
										add_trait = one_legged
									}
									18 = {
										add_trait = one_handed
									}
									16 = {
										add_trait = blinded
									}
									15 = {
										add_trait = disfigured
									}
									7 = {
										add_trait = mangled
									}
								}
							}
							if = {
								limit = { NOT = { has_dlc = "Reapers" }}
								add_trait = maimed
							}
						}
					}
				}
				random_list = {
					60 = {
						ROOT = { 
							change_variable = { which = "beast_success" value = 1 }  #Success
							set_character_flag = beast_success
							clr_character_flag = beast_failure
						}
						modifier = {
							factor = 1.33
							trait = patient
						}
						modifier = {
							factor = 1.33
							trait = wroth
						}
						modifier = {
							factor = 1.33
							trait = brave
						}
						modifier = {
							factor = 1.33
							trait = diligent
						}
						
						modifier = {
							factor = 1.33
							combat_rating = 40
						}
						modifier = {
							factor = 1.33
							combat_rating = 50
						}
					}
					40 = {
						ROOT = { #Failure
							set_character_flag = beast_failure
							clr_character_flag = beast_success
						} 
						modifier = {
							factor = 1.33
							trait = craven
						}
						modifier = {
							factor = 1.33
							NOT = { combat_rating = 20 }
						}
					}
				}
			}
		}
    }
}

#Beast resolution
character_event = {
    id = equus.149
    desc = {
		trigger = {
			OR = {
				is_variable_equal = { which = "beast_success" value = 6 } #Healthy win
				is_variable_equal = { which = "beast_success" value = 5 }
				is_variable_equal = { which = "beast_success" value = 4 }
			}
		}
		text = EVTDESC_equus.149hw
	}
	desc = {
		trigger = {
			OR = {
				is_variable_equal = { which = "beast_success" value = 3 } #Injured win
				is_variable_equal = { which = "beast_success" value = 2 }
			}
		}
		text = EVTDESC_equus.149iw
	}
	desc = {
		trigger = {
			OR = {
				is_variable_equal = { which = "beast_success" value = 1 } #Injured loss
				is_variable_equal = { which = "beast_success" value = 0 } 
			}
		}
		text = EVTDESC_equus.149il
	}
    picture = "GFX_evt_rider_adventure"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		clr_character_flag = beast_success
		clr_character_flag = beast_failure
		clr_character_flag = boar_hunt
		clr_character_flag = bear_hunt
		clr_character_flag = wolf_hunt
		clr_character_flag = lion_hunt
		clr_character_flag = bull_hunt
		clr_character_flag = rabbit_hunt
		if = {
			limit = {
				OR = { 
					is_variable_equal = { which = "beast_success" value = 3 }
					is_variable_equal = { which = "beast_success" value = 2 }
					is_variable_equal = { which = "beast_success" value = 1 }
					is_variable_equal = { which = "beast_success" value = 0 }
				}
			}
			random_list = {
				10 = {
					modifier = {
						factor = 9
						is_variable_equal = { which = "beast_success" value = 3 }
					}
					modifier = {
						factor = 3
						is_variable_equal = { which = "beast_success" value = 2 }
					}
					add_trait = wounded
				}
				10 = {
					modifier = {
						factor = 3
						is_variable_equal = { which = "beast_success" value = 0 }
					}
					if = {
						limit = { has_dlc = "Reapers" }
						add_trait = severely_injured
						resolve_severely_injured_effect = yes
						random_list = {
							63 = {
								add_trait = one_eyed
							}
							20 = {
								add_trait = one_legged
							}
							18 = {
								add_trait = one_handed
							}
							16 = {
								add_trait = blinded
							}
							15 = {
								add_trait = disfigured
							}
							7 = {
								add_trait = mangled
							}
						}
					}
					if = {
						limit = { NOT = { has_dlc = "Reapers" }}
						add_trait = maimed
					}
				}
			}
		}
	}

    option = { 
        name = EVTOPTA_equus.149 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "beast_success" value = 6 }
				is_variable_equal = { which = "beast_success" value = 5 }
				is_variable_equal = { which = "beast_success" value = 4 }
				is_variable_equal = { which = "beast_success" value = 3 }
				is_variable_equal = { which = "beast_success" value = 2 }
			}
		}
		clr_quest = military_knights_quest_beast #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = {
        name = EVTOPTB_equus.149 #Loss
		trigger = {
			OR = {
				is_variable_equal = { which = "beast_success" value = 1 }
				is_variable_equal = { which = "beast_success" value = 0 }
			}
		}
		clr_quest = military_knights_quest_beast #remove the quest
		add_mission_fail_influence_effect = yes #quest remove society influence
		change_society_currency = -100 
    }
}


#Escort Pilgrims
society_quest_event = {
    id = equus.150
    desc = EVTDESC_equus.150

    is_triggered_only = yes
   
    option = { 
		name = ACCEPT
		set_quest = military_knights_quest_pilgrim
		hidden_tooltip = {
			set_variable = { which = "pilgrim_success" value = 0 }
		}
		character_event = { id = equus.151 days = 14 random = 7 }
		clr_character_flag = training_quest
		set_character_flag = pilgrim_quest
		clr_character_flag = beast_quest
		clr_character_flag = bandit_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = { factor = 0 }
	}
}

#Pilgrim tombola
character_event = {
    id = equus.151
	hide_window = yes
    is_triggered_only = yes

    immediate = {
		random_list = {
			10 = {
				character_event = { id = equus.153 days = 14 random = 7} #jew attack
			}
			10 = {
				character_event = { id = equus.154 days = 14 random = 7} #judge dispute
			}
			10 = {
				character_event = { id = equus.155 days = 14 random = 7} #bandit attack
			}
			10 = {
				character_event = { id = equus.156 days = 14 random = 7} #disease
			}
			10 = {
				character_event = { id = equus.157 days = 14 random = 7} #lack of supplies
			}
			10 = {
				character_event = { id = equus.158 days = 14 random = 7} #looting	
			}
		}
	}	
}

#Pilgrim results
character_event = {
    id = equus.152
    desc = {
		trigger = {
			has_character_flag = happy_pilgrim
		}
		text = EVTDESC_equus.152h
	}
	desc = {
		trigger = {
			has_character_flag = angry_pilgrim
		}
		text = EVTDESC_equus.152a
	}
    picture = "GFX_evt_pilgrims_epic_journey"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = first_escort
			}
			clr_character_flag = first_escort
			set_character_flag = end_pilgrims
			character_event = { id = equus.159 days = 14 random = 7 } #End
		}
		if = {
			limit = {
				NOT = { has_character_flag = first_escort }
				NOT = { has_character_flag = end_pilgrims }
			}
			set_character_flag = first_escort
			character_event = { id = equus.151 days = 14 random = 7 } #New event
		}
		
	}

    option = { 
        name = EVTOPTA_equus.152 #Happy
		trigger = {
			has_character_flag = happy_pilgrim
		}
		clr_character_flag = happy_pilgrim
    }
	option = { 
        name = EVTOPTB_equus.152 #Angry
		trigger = {
			has_character_flag = angry_pilgrim
		}
		clr_character_flag = angry_pilgrim
    }
}

#Jew attack
character_event = {
    id = equus.153
    desc = EVTDESC_equus.153
    picture = "GFX_evt_peasants"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.152 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.153 #We're all brothers
		trigger = {
			trait = just
			NOT = { trait = zealous }
		}
		tooltip_info = just 
		hidden_tooltip = {
			change_variable = { which = "pilgrim_success" value = 1 }
		}
		set_character_flag = happy_pilgrim
		piety = 100
		add_trait = sympathy_judaism
    }
    option = {
        name = EVTOPTB_equus.153 #Stop dammit
		random_list = {
			60 = {
				add_trait = kind
			}
			40 = {
				add_trait = cynical
			}
		}
		hidden_tooltip = {
			random_list = {
				40 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				60 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.153 #Death to jews
		random_list = {
			60 = {
				add_trait = cruel
			}
			40 = {
				add_trait = zealous
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				40 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.153 #Take their money!
		trigger = {
			trait = greedy
			NOT = { trait = kind }
		}
		tooltip_info = greedy
		set_character_flag = angry_pilgrim
		add_trait = cruel
		wealth = 100
		piety = -200
    }
}


#Dispute on a debt
character_event = {
    id = equus.154
    desc = EVTDESC_equus.154
    picture = "GFX_evt_emissary"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.152 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.154 #I'll pay the debt
		trigger = {
			trait = charitable
		}
		tooltip_info = charitable
		hidden_tooltip = {
			change_variable = { which = "pilgrim_success" value = 1 }
		}
		set_character_flag = happy_pilgrim
		wealth = -50
		piety = 100
		add_trait = kind
    }
    option = {
        name = EVTOPTB_equus.154 #Forgive his debt
		random_list = {
			60 = {
				add_trait = kind
			}
			40 = {
				add_trait = arbitrary
			}
		}
		hidden_tooltip = {
			random_list = {
				40 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				60 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.154 #Pay him back
		random_list = {
			60 = {
				add_trait = just
			}
			40 = {
				add_trait = greedy
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				40 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.154 #Rich people shouldn't be on a pilgrimage (give me the money)
		trigger = {
			trait = arbitrary
			NOT = { trait = kind }
		}
		tooltip_info = arbitrary
		set_character_flag = angry_pilgrim
		add_trait = greedy
		wealth = 100
		piety = -200
    }
}

#Bandit attack
character_event = {
    id = equus.155
    desc = EVTDESC_equus.155
    picture = "GFX_evt_bandits"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.152 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.155 #Charge into the fray
		trigger = {
			trait = brave
		}
		tooltip_info = brave
		hidden_tooltip = {
			change_variable = { which = "pilgrim_success" value = 1 }
		}
		set_character_flag = happy_pilgrim
		random_list = {
			40 = {
				add_trait = wounded
			}
			60 = {
			}
		}
    }
    option = {
        name = EVTOPTB_equus.155 #Protect the baggage
		random_list = {
			60 = {
				add_trait = diligent
			}
			40 = {
				add_trait = cynical
			}
		}
		hidden_tooltip = {
			random_list = {
				40 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				60 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = greedy
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.155 #Protect the villagers
		add_trait = kind
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				40 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.155 #Take advantage in the confusion (greedy/lustful)
		trigger = {
			trait = arbitrary
			NOT = { trait = kind }
		}
		tooltip_info = arbitrary
		set_character_flag = angry_pilgrim
		random_list = {
			60 = {
				add_trait = greedy
			}
			40 = {
				add_trait = lustful
			}
		}
		wealth = 50
		piety = -100
    }
}

#Disease
character_event = {
    id = equus.156
    desc = EVTDESC_equus.156
    picture = "GFX_evt_illness"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.152 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.156 #Tend to the sick
		set_character_flag = happy_pilgrim
		add_trait = kind
		add_trait = charitable
		
		hidden_tooltip = {
			change_variable = { which = "pilgrim_success" value = 1 }
			random_list = {
				5 = {
					add_trait = has_typhus
				}
				7 = {
					add_trait = has_tubercolosis
				}
				9 = {
					add_trait = has_dysentery
				}
				7 = {
					add_trait = flu
				}
				7 = {
					add_trait = has_typhoid_fever
				}
				11 = {
					add_trait = has_measles
				}
				4 = {
					add_trait = has_pneumonia
				}
				7 = {
					add_trait = has_small_pox
				}
				3 = {
					add_trait = has_bubonic_plague
				}
				40 = {
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.156 #Send your men to help
		random_list = {
			60 = {
				add_trait = charitable
			}
			40 = {
				add_trait = kind
			}
		}
		hidden_tooltip = {
			random_list = {
				5 = {
					add_trait = has_typhus
				}
				7 = {
					add_trait = has_tubercolosis
				}
				9 = {
					add_trait = has_dysentery
				}
				7 = {
					add_trait = flu
				}
				7 = {
					add_trait = has_typhoid_fever
				}
				11 = {
					add_trait = has_measles
				}
				4 = {
					add_trait = has_pneumonia
				}
				7 = {
					add_trait = has_small_pox
				}
				3 = {
					add_trait = has_bubonic_plague
				}
				80 = {
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				40 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.156 #Leave the sick behind
		random_list = {
			60 = {
				add_trait = cynical
			}
			40 = {
				add_trait = cruel
			}
		}
		hidden_tooltip = {
			random_list = {
				40 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				60 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.156 #Take the belongings from the dead
		trigger = {
			trait = greedy
			NOT = { trait = kind }
		}
		tooltip_info = greedy
		set_character_flag = angry_pilgrim
		add_trait = cynical
		wealth = 100
		piety = -200
		hidden_tooltip = {
			random_list = {
				5 = {
					add_trait = has_typhus
				}
				7 = {
					add_trait = has_tubercolosis
				}
				9 = {
					add_trait = has_dysentery
				}
				7 = {
					add_trait = flu
				}
				7 = {
					add_trait = has_typhoid_fever
				}
				11 = {
					add_trait = has_measles
				}
				4 = {
					add_trait = has_pneumonia
				}
				7 = {
					add_trait = has_small_pox
				}
				3 = {
					add_trait = has_bubonic_plague
				}
				60 = {
				}
			}
		}
    }
}

#Lack of supplies
character_event = {
    id = equus.157
    desc = EVTDESC_equus.157
    picture = "GFX_evt_bad_news"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.152 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.157 #Give enough for the whole trip
		hidden_tooltip = {
			change_variable = { which = "pilgrim_success" value = 1 }
		}
		set_character_flag = happy_pilgrim
		wealth = -100
		piety = 200
		add_trait = charitable
    }
    option = {
        name = EVTOPTC_equus.157 #Raid the neighboring villages
		random_list = {
			60 = {
				add_trait = arbitrary
			}
			40 = {
				add_trait = cruel
			}
		}
		piety = -50
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				40 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTB_equus.157 #Give a little from your stores
		random_list = {
			60 = {
				add_trait = charitable
			}
			40 = {
				add_trait = kind
			}
		}
		wealth = -50
		piety = 100
		hidden_tooltip = {
			random_list = {
				40 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				60 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.157 #I can sell you my goods
		trigger = {
			trait = greedy
		}
		tooltip_info = greedy
		set_character_flag = angry_pilgrim
		wealth = 100
    }
}

#Looting
character_event = {
    id = equus.158
    desc = EVTDESC_equus.158
    picture = "GFX_evt_burning_house"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.152 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.158 #Reimburse the villagers
		trigger = {
			trait = charitable
		}
		tooltip_info = charitable
		hidden_tooltip = {
			change_variable = { which = "pilgrim_success" value = 1 }
		}
		set_character_flag = happy_pilgrim
		wealth = -100
		piety = 200
    }
    option = { 
        name = EVTOPTC_equus.158 #Have them pay 
		random_list = {
			60 = {
				add_trait = greedy
			}
			40 = {
				add_trait = just
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				40 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTB_equus.158 #Punish the perpetrators
		random_list = {
			60 = {
				add_trait = just
			}
			40 = {
				add_trait = diligent
			}
		}
		piety = 50
		hidden_tooltip = {
			random_list = {
				40 = {
					change_variable = { which = "pilgrim_success" value = 1 }
					set_character_flag = happy_pilgrim
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = zealous
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = just
					}
					modifier = {
						factor = 1.33
						diplomacy = 10
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
				}
				60 = {
					set_character_flag = angry_pilgrim
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = cynical
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 10 }
					}
					modifier = {
						factor = 1.33
						NOT = { diplomacy = 5 }
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.158 #Sequester the goods
		trigger = {
			trait = greedy
		}
		tooltip_info = greedy
		set_character_flag = angry_pilgrim
		wealth = 100
    }
}

#Pilgrim resolution
character_event = {
    id = equus.159
    desc = {
		trigger = {
			is_variable_equal = { which = "pilgrim_success" value = 2 } #Bonus win
		}
		text = EVTDESC_equus.159bw
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "pilgrim_success" value = 1 } #Win
		}
		text = EVTDESC_equus.159w
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "pilgrim_success" value = 0 } #Loss
		}
		text = EVTDESC_equus.159l
	}
    picture = "GFX_evt_carriage"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		clr_character_flag = pilgrim_success
		clr_character_flag = pilgrim_failure
		clr_character_flag = end_pilgrims
	}

    option = { 
        name = EVTOPTA_equus.159 #Bonus Win
		trigger = {
			is_variable_equal = { which = "pilgrim_success" value = 2 }
		}
		clr_quest = military_knights_quest_pilgrim #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
		wealth = 100
    }
	option = { 
        name = EVTOPTB_equus.159 #Win
		trigger = {
			is_variable_equal = { which = "pilgrim_success" value = 1 }
		}
		clr_quest = military_knights_quest_pilgrim #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = {
        name = EVTOPTC_equus.159 #Loss
		trigger = {
			is_variable_equal = { which = "pilgrim_success" value = 0 }
		}
		clr_quest = military_knights_quest_pilgrim #remove the quest
		add_mission_fail_influence_effect = yes #quest remove society influence
		change_society_currency = -100 
    }
}

#Training quest

#Trainer
character_event = {
    id = equus.160
    hide_window = yes #instant event, no need to show it
    is_triggered_only = yes
    immediate = { FROM = { society_quest_event = { id = equus.161 days = 14 random = 7 } } }
}

#This event is set as a society_quest_event, not character_event. This is the accept or refuse the quest event, the next parts of the quest use the regular character_event.
society_quest_event = {
    id = equus.161
    desc = EVTDESC_equus.161

    is_triggered_only = yes
   
    option = { 
		name = ACCEPT
		set_quest = military_knights_quest_training 
		character_event = { id = equus.162 days = 14 random = 7 }
		set_character_flag = training_quest
		clr_character_flag = pilgrim_quest
		clr_character_flag = beast_quest
		clr_character_flag = bandit_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = { factor = 0 }
	}
}

#Actual training
character_event = {
    id = equus.162
    desc = EVTDESC_equus.162
    picture = "GFX_evt_family_feud_republic"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
	
	immediate = { 
		character_event = { id = equus.163 days = 14 random = 7 } 
		clr_character_flag = training_success2
		clr_character_flag = training_success1
		clr_character_flag = training_failure0
		clr_character_flag = training_failure1
		clr_character_flag = training_failure2
	}


    option = { 
        name = EVTOPTA_equus.162 #Sword
		random_list = {
			15 = {
				add_trait = duelist
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = duelist }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			25 = {
				add_one_duel_experience_modifier = yes
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 10 }
				}
			}
			15 = {
				change_martial = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
			10 = {
				add_trait = wounded
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
		}
    }
    option = { 
        name = EVTOPTB_equus.162 #Lance
		random_list = {
			15 = {
				add_trait = cavalry_leader
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = cavalry_leader }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			25 = {
				add_one_duel_experience_modifier = yes
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 10 }
				}
			}
			15 = {
				change_martial = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
			10 = {
				add_trait = wounded
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.162 #Axe
		random_list = {
			15 = {
				add_trait = light_foot_leader
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = light_foot_leader }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			25 = {
				add_one_duel_experience_modifier = yes
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 10 }
				}
			}
			15 = {
				change_martial = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
			10 = {
				add_trait = wounded
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.162 #Mace
		random_list = {
			15 = {
				add_trait = heavy_infantry_leader
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = heavy_infantry_leader }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			25 = {
				add_one_duel_experience_modifier = yes
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { martial = 10 }
				}
			}
			15 = {
				change_martial = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
			10 = {
				add_trait = wounded
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { martial = 10 }}
				}
			}
		}
    }
}

#Training resolution
character_event = {
    id = equus.163
    desc = {
		trigger = {
			OR = {
				has_character_flag = training_success2 #Success
				has_character_flag = training_success1
			}
		}
		text = EVTDESC_equus.163s
	}
	desc = {
		trigger = {
			has_character_flag = training_failure0 #Neutral
		}
		text = EVTDESC_equus.163n
	}
	desc = {
		trigger = {
			OR = { 
				has_character_flag = training_failure2 #Failure
				has_character_flag = training_failure1
			}
		}
		text = EVTDESC_equus.163f
	}
    picture = "GFX_evt_family_feud_republic"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_equus.163 #Success
		trigger = {
			OR = {
				has_character_flag = training_success2 
				has_character_flag = training_success1
			}
		}
		clr_quest = military_knights_quest_training #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 100
		event_target:quest_collaborator = {
			opinion = {
				modifier = opinion_mutual_respect
				who = ROOT
				years = 5
			}
		}
		opinion = {
			modifier = opinion_mutual_respect
			who = event_target:quest_collaborator
			years = 5
		}
    }
	option = { 
        name = EVTOPTB_equus.163 #Neutral
		trigger = {
			has_character_flag = training_failure0
		}
		clr_quest = military_knights_quest_training #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
    }
	option = {
        name = EVTOPTC_equus.163 #Failure
		trigger = {
			OR = { 
				has_character_flag = training_failure2 
				has_character_flag = training_failure1
			}
		}
		clr_quest = military_knights_quest_training #remove the quest
		add_mission_fail_succeed_effect = yes #quest remove society influence
		change_society_currency = -100 
		event_target:quest_collaborator = {
			opinion = {
				modifier = opinion_unimpressed
				who = ROOT
				years = 5
			}
		}
		opinion = {
			modifier = opinion_unimpressed
			who = event_target:quest_collaborator
			years = 5
		}
    }
}

##Diplomatic missions

#Mission tombola, this is where an hidden event choose a quest. I have made only one quest, do look for other mission tombola in the vanilla files for more example.
character_event = {
    id = equus.230
    hide_window = yes

    is_triggered_only = yes
    
	is_in_society = yes

	trigger = {
		OR = {
			society_member_of = diplomatic_knights
			society_member_of = diplomatic_knights1
			society_member_of = diplomatic_knights2
		}
		has_any_quest = no #cannot have more than 1 shown
		NOT = { has_character_modifier = quest_cooldown_timer } #to avoid spam and delay it for people who refused a quest.
		NOT = { is_inaccessible_trigger = yes }
		prisoner = no
		society = { #look if there is a close member to give you the quest
			any_society_member = {
				NOT = { character = ROOT }
				prisoner = no
				is_within_diplo_range = ROOT
				opinion = { who = ROOT value = 0 }
			}
		}
	}

    immediate = {
    	#Picks out mission giver
    	random_list = {
    		20 = { #International society member
    			society = {
    				random_society_member = {
    					limit = { 	
							NOT = { character = ROOT }
							prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
    					}
    					save_event_target_as = quest_collaborator
    				}
    			}
    		}
    		40 = { #Realm society member is there is any
    			trigger = {
    				society = {
    					any_society_member = {
    						NOT = { character = ROOT }
    						prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
							same_realm = ROOT
    					}
    				}
    			}
    			society = {
    				random_society_member = {
    					limit = { 	
    						NOT = { character = ROOT }
    						prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
							same_realm = ROOT
    					}
    					save_event_target_as = quest_collaborator
    				}
    			}
    		}
			60 = { #Lady/Lad
				trigger = {
					any_friend = {
						has_opinion_modifier = {
							who = ROOT 
							modifier = opinion_courtly_lover
						}
					}
				}
				random_friend = {
					limit = {
						has_opinion_modifier = {
							who = ROOT 
							modifier = opinion_courtly_lover
						}
					}
					save_event_target_as = quest_collaborator
				}
			}
    	}

    	#Randomizes mission
		random_list = {
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = rival_quest
				}
				modifier = {
					factor = 0 
					event_target:quest_collaborator = { num_of_rivals = 0 }
				}
				event_target:quest_collaborator = { character_event = { id = equus.240 days = 14 random = 7 }} #Reconcile rival
			}
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = escape_quest
				}
				modifier = {
					factor = 100 
					event_target:quest_collaborator = { imprisoned_days = 10 }
				}
				modifier = {
					factor = 0 
					event_target:quest_collaborator = { imprisoned_days = 0 }
				}
				event_target:quest_collaborator = { character_event = { id = equus.247 days = 14 random = 7 }} #Break out of captivity
			}
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = heirloom_quest
				}
				modifier = {
					factor = 0 
					event_target:quest_collaborator = { has_artifact = ancestor_ring_4 }
				}
				modifier = {
					factor = 0 
					event_target:quest_collaborator = { has_artifact = ancestor_ring_3 }
				}
				modifier = {
					factor = 0 
					event_target:quest_collaborator = { has_artifact = ancestor_ring_2 }
				}
				modifier = {
					factor = 0 
					event_target:quest_collaborator = { has_artifact = ancestor_ring_1 }
				}
				modifier = {
					factor = 0 
					NOT = {
						event_target:quest_collaborator = { 
							any_dynasty_member_even_if_dead = {
								OR = {
									tier = count
									tier = duke
									tier = king
									tier = emperor
								}
							}
						}
					}
				}
				event_target:quest_collaborator = { character_event = { id = equus.253 days = 14 random = 7 }} #Find heirloom
			}
			25 = { 
				modifier = {
					factor = 0 
					has_character_flag = training_quest
				}
				event_target:quest_collaborator = { character_event = { id = equus.259 days = 14 random = 7 }} #Improve diplomacy skill
			}
			
			50 = { # AI bypasses missions at times and goes directly to success/failure, increase the 50 if you add more mission or you could delete this whole { }.
				modifier = {
					factor = 0
					ai = no
				}
				random_list = {
					70 = { #success, harder the more influencial the society is
						modifier = {
							factor = 0.9
							society_influence >= 30
						}
						modifier = {
							factor = 0.9
							society_influence >= 40
						}
						modifier = {
							factor = 0.8
							society_influence >= 50
						}
						modifier = {
							factor = 0.7
							society_influence >= 70
						}
						modifier = {
							factor = 0.6
							society_influence >= 80
						}
						modifier = {
							factor = 0.5
							society_influence >= 90
						}
						add_mission_succeed_influence_effect = yes
					}
					30 = { #failure
						add_mission_fail_influence_effect = yes
					}
				}
			}
			
			100 = { #AI refuse mission
				modifier = {
					factor = 0
					ai = no
				}
			}
    	}
    }
}

#Reconcile rival

#Bounce
character_event = {
    id = equus.240
    hide_window = yes #instant event, no need to show it
    is_triggered_only = yes
    immediate = { FROM = { society_quest_event = { id = equus.241 days = 14 random = 7 }}}
}

#Accept or refuse quest event
society_quest_event = {
    id = equus.241
    desc = EVTDESC_equus.241

    is_triggered_only = yes
   
   immediate = {
		event_target:quest_collaborator = { 
			random_rival = {
				save_event_target_as = rival_target
			}
		}
	}	
   
    option = { 
		name = ACCEPT
		set_quest = diplomatic_knights_quest_rival 
		character_event = { id = equus.242 days = 14 random = 7 }
		clr_character_flag = training_quest
		clr_character_flag = heirloom_quest
		clr_character_flag = escape_quest
		set_character_flag = rival_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#Choose mode
character_event = {
    id = equus.242
    desc = EVTDESC_equus.242
    picture = GFX_evt_recieve_letter
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_equus.242 #Violent
		trigger = {
			martial = 10
		}
		tooltip_info = martial
		hidden_tooltip = {
			character_event = { id = equus.243 days = 14 random = 7 }
		}
    }
    option = {
		tooltip_info = diplomacy
        name = EVTOPTB_equus.242 #Diplomatic
		hidden_tooltip = {
			character_event = { id = equus.244 days = 14 random = 7 }
		}
    }
	option = {
        name = EVTOPTC_equus.242 #Intrigue
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			character_event = { id = equus.245 days = 14 random = 7 }
		}
    }
}

#Martial
character_event = {
    id = equus.243
    desc = EVTDESC_equus.243
    picture = GFX_evt_poke_king_in_chest
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_equus.243 #Take advantage of shyness
		trigger = {
			event_target:rival_target = {
				trait = shy
			}
		}
		hidden_tooltip = {
			random_list = {
				15 = {
					modifier = {
						factor = 1.1
						martial = 10
					}
					modifier = {
						factor = 1.1
						martial = 12
					}
					modifier = {
						factor = 1.1
						martial = 14
					}
					modifier = {
						factor = 1.1
						martial = 16
					}
					modifier = {
						factor = 1.1
						martial = 18
					}
					modifier = {
						factor = 1.1
						martial = 20
					}
					modifier = {
						factor = 1.1
						trait = gregarious
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = slothful
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = craven
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						trait = shy
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTB_equus.243 #Take advantage of fear
		trigger = {
			event_target:rival_target = {
				trait = craven
			}
		}
		hidden_tooltip = {
			random_list = {
				15 	= {
					modifier = {
						factor = 1.1
						martial = 10
					}
					modifier = {
						factor = 1.1
						martial = 12
					}
					modifier = {
						factor = 1.1
						martial = 14
					}
					modifier = {
						factor = 1.1
						martial = 16
					}
					modifier = {
						factor = 1.1
						martial = 18
					}
					modifier = {
						factor = 1.1
						martial = 20
					}
					modifier = {
						factor = 1.1
						trait = brave
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = slothful
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = craven
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						trait = craven
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTC_equus.243 #Take advantage of paranoia
		trigger = {
			event_target:rival_target = {
				trait = paranoid
			}
		}
		hidden_tooltip = {
			random_list = {
				15 	= {
					modifier = {
						factor = 1.1
						martial = 10
					}
					modifier = {
						factor = 1.1
						martial = 12
					}
					modifier = {
						factor = 1.1
						martial = 14
					}
					modifier = {
						factor = 1.1
						martial = 16
					}
					modifier = {
						factor = 1.1
						martial = 18
					}
					modifier = {
						factor = 1.1
						martial = 20
					}
					modifier = {
						factor = 1.1
						trait = trusting
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = slothful
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = craven
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						trait = paranoid
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTD_equus.243 #Rough up
		hidden_tooltip = {
			random_list = {
				10 	= {
					modifier = {
						factor = 1.1
						martial = 10
					}
					modifier = {
						factor = 1.1
						martial = 12
					}
					modifier = {
						factor = 1.1
						martial = 14
					}
					modifier = {
						factor = 1.1
						martial = 16
					}
					modifier = {
						factor = 1.1
						martial = 18
					}
					modifier = {
						factor = 1.1
						martial = 20
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = slothful
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = craven
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					set_character_flag = not_convinced
					add_trait = wounded
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
}

#Diplomatic
character_event = {
    id = equus.244
    desc = EVTDESC_equus.244
    picture = GFX_evt_council
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_equus.244 #Praise your companion to them
		trigger = {
			event_target:quest_collaborator = {
				OR = {
					trait = chaste
					trait = temperate
					trait = charitable
					trait = diligent
					trait = patient
					trait = kind
					trait = humble
					trait = just
					trait = brave
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				15 = {
					modifier = {
						factor = 1.1
						diplomacy = 10
					}
					modifier = {
						factor = 1.1
						diplomacy = 12
					}
					modifier = {
						factor = 1.1
						diplomacy = 14
					}
					modifier = {
						factor = 1.1
						diplomacy = 16
					}
					modifier = {
						factor = 1.1
						diplomacy = 18
					}
					modifier = {
						factor = 1.1
						diplomacy = 20
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = chaste
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = temperate
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = charitable
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = diligent
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = patient
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = kind
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = humble
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = brave
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = just
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = humble
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = trusting
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = lustful
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = gluttonous
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = greedy
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = slothful
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = wroth
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = envious
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = proud
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = craven
						}
					}
					modifier = {
						factor = 1.1
						event_target:quest_collaborator = {
							trait = arbitrary
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = proud
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = stubborn
						}
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTB_equus.244 #Flatter them
		trigger = {
			event_target:rival_target = {
				OR = {
					trait = proud
					trait = envious
					trait = ambitious
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				15 	= {
					modifier = {
						factor = 1.1
						diplomacy = 10
					}
					modifier = {
						factor = 1.1
						diplomacy = 12
					}
					modifier = {
						factor = 1.1
						diplomacy = 14
					}
					modifier = {
						factor = 1.1
						diplomacy = 16
					}
					modifier = {
						factor = 1.1
						diplomacy = 18
					}
					modifier = {
						factor = 1.1
						diplomacy = 20
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = proud
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = envious
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = ambitious
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = humble
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = kind
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = content
						}
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTC_equus.244 #Appeal to better nature
		trigger = {
			event_target:rival_target = {
				OR = {
					trait = humble
					trait = charitable
					trait = patient
					trait = kind
					trait = content
					trait = trusting
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				15 	= {
					modifier = {
						factor = 1.1
						diplomacy = 10
					}
					modifier = {
						factor = 1.1
						diplomacy = 12
					}
					modifier = {
						factor = 1.1
						diplomacy = 14
					}
					modifier = {
						factor = 1.1
						diplomacy = 16
					}
					modifier = {
						factor = 1.1
						diplomacy = 18
					}
					modifier = {
						factor = 1.1
						diplomacy = 20
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = humble
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = charitable
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = patient
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = kind
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = content
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = trusting
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = proud
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = greedy
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = wroth
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = proud
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = ambitious
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = stubborn
						}
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTD_equus.244 #Discuss
		hidden_tooltip = {
			random_list = {
				10 	= {
					modifier = {
						factor = 1.1
						diplomacy = 10
					}
					modifier = {
						factor = 1.1
						diplomacy = 12
					}
					modifier = {
						factor = 1.1
						diplomacy = 14
					}
					modifier = {
						factor = 1.1
						diplomacy = 16
					}
					modifier = {
						factor = 1.1
						diplomacy = 18
					}
					modifier = {
						factor = 1.1
						diplomacy = 20
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
}


#Intrigue
character_event = {
    id = equus.245
    desc = EVTDESC_equus.245
    picture = GFX_evt_lunatic
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_equus.245 #Blackmail them
		trigger = {
			event_target:quest_collaborator = {
				OR = {
					trait = craven
					trait = lustful
					trait = arbitrary
					trait = deceitful
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				15 = {
					modifier = {
						factor = 1.1
						intrigue = 10
					}
					modifier = {
						factor = 1.1
						intrigue = 12
					}
					modifier = {
						factor = 1.1
						intrigue = 14
					}
					modifier = {
						factor = 1.1
						intrigue = 16
					}
					modifier = {
						factor = 1.1
						intrigue = 18
					}
					modifier = {
						factor = 1.1
						intrigue = 20
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = craven
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = lustful
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = arbitrary
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = deceitful
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = brave
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = chaste
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = just
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = honest
						}
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTB_equus.245 #Bribe them
		trigger = {
			event_target:rival_target = {
				OR = {
					trait = greedy
					trait = gluttonous
					trait = lustful
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				15 	= {
					modifier = {
						factor = 1.1
						intrigue = 10
					}
					modifier = {
						factor = 1.1
						intrigue = 12
					}
					modifier = {
						factor = 1.1
						intrigue = 14
					}
					modifier = {
						factor = 1.1
						intrigue = 16
					}
					modifier = {
						factor = 1.1
						intrigue = 18
					}
					modifier = {
						factor = 1.1
						intrigue = 20
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = greedy
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = gluttonous
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = lustful
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = charitable
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = temperate
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = chaste
						}
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTC_equus.245 #Fabricate evidence that it wasn't your friend
		trigger = {
			event_target:rival_target = {
				OR = {
					trait = trusting
					trait = paranoid
					trait = content
					trait = arbitrary
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				15 	= {
					modifier = {
						factor = 1.1
						intrigue = 10
					}
					modifier = {
						factor = 1.1
						intrigue = 12
					}
					modifier = {
						factor = 1.1
						intrigue = 14
					}
					modifier = {
						factor = 1.1
						intrigue = 16
					}
					modifier = {
						factor = 1.1
						intrigue = 18
					}
					modifier = {
						factor = 1.1
						intrigue = 20
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = trusting
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = paranoid
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = content
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = arbitrary
						}
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = trusting
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = paranoid
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = ambitious
						}
					}
					modifier = {
						factor = 1.1
						event_target:rival_target = {
							trait = just
						}
					}
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
	option = { 
        name = EVTOPTD_equus.245 #Lie
		hidden_tooltip = {
			random_list = {
				10 	= {
					modifier = {
						factor = 1.1
						intrigue = 10
					}
					modifier = {
						factor = 1.1
						intrigue = 12
					}
					modifier = {
						factor = 1.1
						intrigue = 14
					}
					modifier = {
						factor = 1.1
						intrigue = 16
					}
					modifier = {
						factor = 1.1
						intrigue = 18
					}
					modifier = {
						factor = 1.1
						intrigue = 20
					}
					set_character_flag = convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
				20 = {
					set_character_flag = not_convinced
					character_event = { id = equus.246 days = 14 random = 7 }
				}
			}
		}
    }
}

#Success or failure
character_event = {
    id = equus.246
    desc = {
		trigger = {
			has_character_flag = convinced
		}
		text = EVTDESC_equus.246s
	}
	desc = {
		trigger = {
			has_character_flag = not_convinced
		}
		text = EVTDESC_equus.246f
	}
    picture = GFX_evt_recieve_letter
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

   
    option = { 
		trigger = {
			has_character_flag = convinced
		}
		name = EVTOPTA_equus.246 #Succeed
		clr_quest = diplomatic_knights_quest_rival #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 100
		event_target:quest_collaborator = {
			remove_rival = event_target:rival_target
			opinion = { 
				modifier = opinion_grateful 
				who = ROOT 
				years = 5 
			}
		}
		clr_character_flag = convinced
	}
	
	option = { 
		trigger = {
			has_character_flag = not_convinced
		}
		name = EVTOPTB_equus.246 #Fail
		clr_quest = diplomatic_knights_quest_rival #remove the quest
		clr_character_flag = convinced
		change_society_currency = -100
	}
}

##Break out of prison

#Check if not in prison
character_event = {
	id = equus.9247
    hide_window = yes
    is_triggered_only = yes
	trigger = {
		has_any_quest = yes
	}
	
	immediate = {
		character_event = { id = equus.9247 days = 14}
		character_event = { id = equus.9248 days = 14}
	}
}

#End if no longer in prison
character_event = {
	id = equus.9248
    desc = EVTDESC_equus.9248
    picture = GFX_evt_eavesdropping
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
	trigger = {
		event_target:quest_collaborator = { prisoner = no }
	}
	
	option = {
        name = EVTOPTA_equus.9248
		clr_quest = diplomatic_knights_quest_escape #remove the quest
    }
}

#Bounce
character_event = {
    id = equus.247
    hide_window = yes #instant event, no need to show it
    is_triggered_only = yes
    immediate = { FROM = { society_quest_event = { id = equus.248 days = 14 random = 7 }}}
}

#Accept or refuse quest event
society_quest_event = {
    id = equus.248
    desc = EVTDESC_equus.248

    is_triggered_only = yes
   
    option = { 
		name = ACCEPT
		set_quest = diplomatic_knights_quest_escape 
		character_event = { id = equus.249 days = 14 random = 7 }
		clr_character_flag = training_quest
		clr_character_flag = heirloom_quest
		set_character_flag = escape_quest
		clr_character_flag = rival_quest
		character_event = { id = equus.247 days = 14}
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}



#Event chain start (How to get in)
character_event = {
    id = equus.249
    desc = EVTDESC_equus.249
    picture = GFX_evt_eavesdropping
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.250 days = 14 random = 7 }
		set_variable = { which = "escape_success" value = 0 }
	}

    option = { 
        name = EVTOPTA_equus.249 #Befriend a guard
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
					modifier = {
						factor = 1.33
						diplomacy = 25
					}
				}
				50 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.249 #Bribe servants
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
					modifier = {
						factor = 1.33
						diplomacy = 25
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = charitable
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
				}
				50 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = greedy
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
				}
			}
		}
		wealth = -50
    }
	option = {
        name = EVTOPTC_equus.249 #Steal Plans
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
					modifier = {
						factor = 1.33
						intrigue = 25
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
				}
				25 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = trusting
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.249 #Dig a tunnel
		trigger = {
			trait = diligent
		}
		tooltip_info = diligent
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 2
						trait = architect
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
				}
				25 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
				}
			}
		}
    }
}


#Choose contact
character_event = {
    id = equus.250
    desc = EVTDESC_equus.250
    picture = GFX_evt_courtiers_talking
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.251 days = 14 random = 7 }
		if = {
			limit = {
				NOT = {
					event_target:quest_collaborator = {
						any_host_courtier = {
							is_playable = no
							prisoner = no
							age = 16
						}
					}
				}
			}
			event_target:quest_collaborator = {
				host = {
					create_character = {
						age = 20
						random_traits = yes 
						save_event_target_as = escape_mole
					}
				}
			}
			set_character_flag = artificial_assistant
		}
	}

    option = { 
        name = EVTOPTA_equus.250 #Backup guy
		trigger = {
			has_character_flag = artificial_assistant
		}
		hidden_tooltip = {
			clr_character_flag = artificial_assistant
			random_list = {
				50 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = charitable }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = kind }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = greedy }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = trusting }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { intrigue = 10 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { intrigue = 15 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { intrigue = 20 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { intrigue = 25 }
					}
				}
				50 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = impaler }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = envious }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = arbitrary }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = cruel }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = deceitful }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = just }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = paranoid }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole = { trait = cynical }
					}
					modifier = {
						factor = 1.33
						NOT = { event_target:escape_mole = { intrigue = 10 }}
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTB_equus.250 #Actual courtier
		random_host_courtier = {
			is_playable = no
			prisoner = no
			age = 16
			save_event_target_as = escape_mole1
		}
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = charitable }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = kind }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = greedy }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = trusting }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { intrigue = 10 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { intrigue = 15 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { intrigue = 20 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { intrigue = 25 }
					}
				}
				25 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = impaler }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = envious }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = arbitrary }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = cruel }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = deceitful }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = just }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = paranoid }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole1 = { trait = cynical }
					}
					modifier = {
						factor = 1.33
						NOT = { event_target:escape_mole1 = { intrigue = 10 }}
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.250 #Actual courtier
		random_host_courtier = {
			is_playable = no
			prisoner = no
			age = 16
			save_event_target_as = escape_mole2
		}
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = charitable }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = kind }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = greedy }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = trusting }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { intrigue = 10 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { intrigue = 15 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { intrigue = 20 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { intrigue = 25 }
					}
				}
				25 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = impaler }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = envious }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = arbitrary }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = cruel }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = deceitful }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = just }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = paranoid }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole2 = { trait = cynical }
					}
					modifier = {
						factor = 1.33
						NOT = { event_target:escape_mole2 = { intrigue = 10 }}
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.250 #Actual courtier
		random_host_courtier = {
			is_playable = no
			prisoner = no
			age = 16
			save_event_target_as = escape_mole3
		}
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = charitable }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = kind }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = greedy }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = trusting }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { intrigue = 10 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { intrigue = 15 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { intrigue = 20 }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { intrigue = 25 }
					}
				}
				25 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = impaler }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = envious }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = arbitrary }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = cruel }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = deceitful }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = just }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = paranoid }
					}
					modifier = {
						factor = 1.33
						event_target:escape_mole3 = { trait = cynical }
					}
					modifier = {
						factor = 1.33
						NOT = { event_target:escape_mole3 = { intrigue = 10 }}
					}
				}
			}
		}
    }
}

#How to get out
character_event = {
    id = equus.251
    desc = EVTDESC_equus.251
    picture = GFX_evt_hiding_from_pursuers
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.252 days = 14 random = 7 }
	}

    option = { 
        name = EVTOPTA_equus.251 #Trick
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
					modifier = {
						factor = 1.33
						diplomacy = 25
					}
				}
				50 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
				}
			}
		}
    }
    option = {
        name = EVTOPTB_equus.251 #Fight
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						martial = 10
					}
					modifier = {
						factor = 1.33
						martial = 15
					}
					modifier = {
						factor = 1.33
						martial = 20
					}
					modifier = {
						factor = 1.33
						martial = 25
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = strong
					}
					modifier = {
						factor = 1.33
						trait = robust
					}
					modifier = {
						factor = 1.33
						trait = cruel
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = stubbron
					}
					modifier = {
						factor = 1.33
						trait = envious
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
				}
				50 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = shy
					}
					modifier = {
						factor = 1.33
						trait = trusting
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = weak
					}
					modifier = {
						factor = 1.33
						trait = feeble
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = charitable
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.251 #Stealth
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "escape_success" value = 1 }  #Success
					set_character_flag = escape_success
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
					modifier = {
						factor = 1.33
						intrigue = 25
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
				}
				25 = {
					set_character_flag = escape_failure #Failure
					modifier = {
						factor = 1.33
						trait = craven
					}
					modifier = {
						factor = 1.33
						trait = arbitrary
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
				}
			}
		}
    }
}

#Escape resolution
character_event = {
    id = equus.252
    desc = {
		trigger = {
			is_variable_equal = { which = "escape_success" value = 3 } #Healthy win
		}
		text = EVTDESC_equus.252hw
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "escape_success" value = 2 } #Injured win
		}
		text = EVTDESC_equus.252iw
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "escape_success" value = 1 } #Injured loss
		}
		text = EVTDESC_equus.252inl
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "escape_success" value = 0 } #Imprisoned loss
		}
		text = EVTDESC_equus.252iml
	}
    picture = "GFX_evt_jailbreak"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
	
	immediate = {
		clr_character_flag = escape_success
		clr_character_flag = escape_failure
		if = {
			limit = {
				OR = {
					is_variable_equal = { which = "escape_success" value = 2 }
					is_variable_equal = { which = "escape_success" value = 1 }
				}
			}
			add_trait = wounded
		}
		if = {
			limit = {
				is_variable_equal = { which = "escape_success" value = 0 }
			}
			event_target:quest_collaborator = {
				host = {
					save_event_target_as = imprisoner
				}
			}
			imprison = event_target:imprisoner
			
		}
	}

    option = { 
        name = EVTOPTA_equus.252 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "escape_success" value = 3 }
				is_variable_equal = { which = "escape_success" value = 2 }
			}
		}
		event_target:quest_collaborator = { imprison = no }
		event_target:quest_collaborator = {
			opinion = { 
				modifier = opinion_grateful 
				who = ROOT 
				years = 5 
			}
		}
		clr_quest = diplomatic_knights_quest_escape #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = {
        name = EVTOPTB_equus.252 #Loss
		trigger = {
			OR = {
				is_variable_equal = { which = "escape_success" value = 1 }
				is_variable_equal = { which = "escape_success" value = 0 }
			}
		}
		clr_quest = diplomatic_knights_quest_escape #remove the quest
		add_mission_fail_influence_effect = yes #quest remove society influence
		change_society_currency = -100 
    }
}

##Heirloom

#Bounce
character_event = {
    id = equus.253
    hide_window = yes #instant event, no need to show it
    is_triggered_only = yes
    immediate = { FROM = { society_quest_event = { id = equus.254 days = 14 random = 7 }}}
}

#Accept or refuse quest event
society_quest_event = {
    id = equus.254
    desc = EVTDESC_equus.254

    is_triggered_only = yes
   
    option = { 
		name = ACCEPT
		set_quest = diplomatic_knights_quest_heirloom
		character_event = { id = equus.255 days = 14 random = 7 }
		clr_character_flag = training_quest
		set_character_flag = heirloom_quest
		clr_character_flag = escape_quest
		clr_character_flag = rival_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

##Info

character_event = {
    id = equus.255
    desc = EVTDESC_equus.255
    picture = GFX_evt_library
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.256 days = 14 random = 7 }
		set_variable = { which = "heirloom_success" value = 0 }
	}

    option = { 
        name = EVTOPTA_equus.255 #Talk
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 2
						trait = socializer
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = kind
					}
					modifier = {
						factor = 1.33
						trait = humble
					}
					modifier = {
						factor = 1.33
						trait = gregarious
					}
					modifier = {
						factor = 1.33
						diplomacy = 15
					}
					modifier = {
						factor = 1.33
						diplomacy = 20
					}
					modifier = {
						factor = 1.33
						diplomacy = 25
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = envious
					}
					modifier = {
						factor = 1.33
						trait = proud
					}
					modifier = {
						factor = 1.33
						trait = shy
					}
				}
			}
		}
    }
	option = { 
        name = EVTOPTB_equus.255 #Study
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 2
						trait = mystic
					}
					modifier = {
						factor = 2
						trait = scholar
					}
					modifier = {
						factor = 2
						trait = theologian
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						learning = 15
					}
					modifier = {
						factor = 1.33
						learning = 20
					}
					modifier = {
						factor = 1.33
						learning = 25
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = wroth
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.255 #Steal
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
					modifier = {
						factor = 1.33
						intrigue = 25
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
				}
				25 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = trusting
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTD_equus.255 #Squire
		trigger = {
			random_courtier = {
				has_minor_title = title_knight_squire
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							learning = 20
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							diplomacy = 20
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = erudite
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = gregarious
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = patient
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = humble
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = kind
						}
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = shy
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = wroth
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = proud
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = envious
						}
					}
				}
			}
		}
    }
}

##Beast fight 
character_event = {
    id = equus.256
    desc = {
		trigger = {
			has_character_flag = heirloom_success
		}
		text = EVTDESC_equus.256s
	}
	desc = {
		trigger = {
			has_character_flag = heirloom_failure
		}
		text = EVTDESC_equus.256f
	}
    picture = GFX_evt_bandits
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.257 days = 14 random = 7 }
		clr_character_flag = heirloom_success
		clr_character_flag = heirloom_failure
	}

    option = { 
        name = EVTOPTA_equus.256 #Fight
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 2
						trait = hunter
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						combat_rating = 30
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTB_equus.256 #Squire
		trigger = {
			random_courtier = {
				has_minor_title = title_knight_squire
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							combat_rating = 40
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = brave
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = wroth
						}
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = craven
						}
					}
					modifier = {
						factor = 1.33
						random_courtier = {
							limit = {
								has_minor_title = title_knight_squire
							}
							trait = patient
						}
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.256 #Sneak
		trigger = {
			intrigue = 10
		}
		tooltip_info = intrigue
		hidden_tooltip = {
			random_list = {
				75 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 1.33
						intrigue = 15
					}
					modifier = {
						factor = 1.33
						intrigue = 20
					}
					modifier = {
						factor = 1.33
						intrigue = 25
					}
					modifier = {
						factor = 1.33
						trait = deceitful
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
				}
				25 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = honest
					}
					modifier = {
						factor = 1.33
						trait = trusting
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = slothful
					}
				}
			}
		}
    }
}

##Challenge 
character_event = {
    id = equus.257
    desc = {
		trigger = {
			has_character_flag = heirloom_success
		}
		text = EVTDESC_equus.257s
	}
	desc = {
		trigger = {
			has_character_flag = heirloom_failure
		}
		text = EVTDESC_equus.257f
	}
    picture = GFX_evt_leaning_tower
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

	immediate = {
		character_event = { id = equus.258 days = 14 random = 7 }
		clr_character_flag = heirloom_success
		clr_character_flag = heirloom_failure
	}

    option = { 
        name = EVTOPTA_equus.257 #Force
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 2
						trait = hunter
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = brave
					}
					modifier = {
						factor = 1.33
						combat_rating = 30
					}
					modifier = {
						factor = 1.33
						combat_rating = 40
					}
					modifier = {
						factor = 1.33
						combat_rating = 50
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = craven
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTB_equus.257 #Symbol
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 2
						trait = mystic
					}
					modifier = {
						factor = 2
						trait = scholar
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
					modifier = {
						factor = 1.33
						trait = paranoid
					}
					modifier = {
						factor = 1.33
						learning = 15
					}
					modifier = {
						factor = 1.33
						learning = 20
					}
					modifier = {
						factor = 1.33
						learning = 25
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
					modifier = {
						factor = 1.33
						trait = trusting
					}
				}
			}
		}
    }
	option = {
        name = EVTOPTC_equus.257 #Architecture
		hidden_tooltip = {
			random_list = {
				50 = {
					change_variable = { which = "heirloom_success" value = 1 }  #Success
					set_character_flag = heirloom_success
					modifier = {
						factor = 1.33
						stewardship = 15
					}
					modifier = {
						factor = 1.33
						stewardship = 20
					}
					modifier = {
						factor = 1.33
						stewardship = 25
					}
					modifier = {
						factor = 2
						trait = architect
					}
					modifier = {
						factor = 1.33
						trait = diligent
					}
					modifier = {
						factor = 1.33
						trait = erudite
					}
					modifier = {
						factor = 1.33
						trait = patient
					}
				}
				50 = {
					set_character_flag = heirloom_failure #Failure
					modifier = {
						factor = 1.33
						trait = slothful
					}
					modifier = {
						factor = 1.33
						trait = wroth
					}
				}
			}
		}
    }
}

#Heirloom resolution
character_event = {
    id = equus.258
    desc = {
		trigger = {
			is_variable_equal = { which = "heirloom_success" value = 3 } #Bonus win
		}
		text = EVTDESC_equus.258bw
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "heirloom_success" value = 2 } #Plain win
		}
		text = EVTDESC_equus.258pw
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "heirloom_success" value = 1 } #Loss
		}
		text = EVTDESC_equus.258l
	}
	desc = {
		trigger = {
			is_variable_equal = { which = "heirloom_success" value = 0 } #Disease loss
		}
		text = EVTDESC_equus.258dl
	}
    picture = "GFX_evt_carriage"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
	
	immediate = {
		clr_character_flag = heirloom_success
		clr_character_flag = heirloom_failure
		event_target:quest_collaborator = {
			random_dynasty_member_even_if_dead = {
				limit = {
					is_alive = no
					is_ruler = yes
					NOT = { tier = baron }
				}
				save_event_target_as = ancestor
			}
		}
		if = {
			limit = { is_variable_equal = { which = "heirloom_success" value = 3 }}
			wealth = 100
		}
		if = {
			limit = { is_variable_equal = { which = "heirloom_success" value = 0 }}
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				give_flu_effect = yes
			}
			else = {
				give_ill_effect = yes
			}
		}
	}

    option = { 
        name = EVTOPTA_equus.258 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "heirloom_success" value = 3 }
				is_variable_equal = { which = "heirloom_success" value = 2 }
			}
			event_target:ancestor = {
				tier = emperor
			}
		}
		event_target:quest_collaborator = {
			opinion = { 
				modifier = opinion_grateful 
				who = ROOT 
				years = 5 
			}
			add_artifact = ancestor_ring_4
			new_artifact = {
				set_original_owner = event_target:ancestor
			}
		}
		clr_quest = diplomatic_knights_quest_heirloom #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = { 
        name = EVTOPTA_equus.258 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "heirloom_success" value = 3 }
				is_variable_equal = { which = "heirloom_success" value = 2 }
			}
			event_target:ancestor = {
				tier = king
			}
		}
		event_target:quest_collaborator = {
			opinion = { 
				modifier = opinion_grateful 
				who = ROOT 
				years = 5 
			}
			add_artifact = ancestor_ring_3
			new_artifact = {
				set_original_owner = event_target:ancestor
			}
		}
		clr_quest = diplomatic_knights_quest_heirloom #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = { 
        name = EVTOPTA_equus.258 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "heirloom_success" value = 3 }
				is_variable_equal = { which = "heirloom_success" value = 2 }
			}
			event_target:ancestor = {
				tier = duke
			}
		}
		event_target:quest_collaborator = {
			opinion = { 
				modifier = opinion_grateful 
				who = ROOT 
				years = 5 
			}
			add_artifact = ancestor_ring_2
			new_artifact = {
				set_original_owner = event_target:ancestor
			}
		}
		clr_quest = diplomatic_knights_quest_heirloom #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = { 
        name = EVTOPTA_equus.258 #Win
		trigger = {
			OR = {
				is_variable_equal = { which = "heirloom_success" value = 3 }
				is_variable_equal = { which = "heirloom_success" value = 2 }
			}
			event_target:ancestor = {
				tier = count
			}
		}
		event_target:quest_collaborator = {
			opinion = { 
				modifier = opinion_grateful 
				who = ROOT 
				years = 5 
			}
			add_artifact = ancestor_ring_1
			new_artifact = {
				set_original_owner = event_target:ancestor
			}
		}
		clr_quest = diplomatic_knights_quest_heirloom #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 300
    }
	option = {
        name = EVTOPTB_equus.258 #Loss
		trigger = {
			OR = {
				is_variable_equal = { which = "heirloom_success" value = 1 }
				is_variable_equal = { which = "heirloom_success" value = 0 }
			}
		}
		clr_quest = diplomatic_knights_quest_heirloom #remove the quest
		add_mission_fail_influence_effect = yes #quest remove society influence
		change_society_currency = -100 
    }
}

##Train diplomacy

#Bounce
character_event = {
    id = equus.259
    hide_window = yes #instant event, no need to show it
    is_triggered_only = yes
    immediate = { FROM = { society_quest_event = { id = equus.260 days = 14 random = 7 }}}
}

society_quest_event = {
    id = equus.260
    desc = EVTDESC_equus.260

    is_triggered_only = yes
   
    option = { 
		name = ACCEPT
		set_quest = diplomatic_knights_quest_training 
		character_event = { id = equus.261 days = 14 random = 7 }
		set_character_flag = training_quest
		clr_character_flag = pilgrim_quest
		clr_character_flag = beast_quest
		clr_character_flag = bandit_quest
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }
		add_character_modifier = { #will delay the next quest for a while
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
		ai_chance = { factor = 0 }
	}
}

#Actual training
character_event = {
    id = equus.261
    desc = EVTDESC_equus.261
    picture = "GFX_evt_diplomatic_greeting"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
	
	immediate = { 
		character_event = { id = equus.262 days = 14 random = 7 } 
		clr_character_flag = training_success2
		clr_character_flag = training_success1
		clr_character_flag = training_failure0
		clr_character_flag = training_failure1
		clr_character_flag = training_failure2
	}

	option = { 
        name = EVTOPTA_equus.261 #Conversation
		random_list = {
			15 = {
				add_trait = gregarious
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = gregarious }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			25 = {
				change_diplomacy = 1
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 10 }
				}
			}
			15 = {
				change_diplomacy = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
			10 = {
				add_trait = shy
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = shy }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
		}
    }
    option = { 
        name = EVTOPTB_equus.261 #Charity
		random_list = {
			15 = {
				random_list = {
					66 = { add_trait = charitable }
					33 = { add_trait = kind }
				}
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = charitable }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = kind }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			25 = {
				change_diplomacy = 1
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 10 }
				}
			}
			15 = {
				change_diplomacy = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
			10 = {
				random_list = {
					66 = { add_trait = greedy }
					33 = { add_trait = wroth }
				}
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = greedy }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
		}
    }
	
	option = { 
        name = EVTOPTC_equus.261 #Justice
		random_list = {
			15 = {
				random_list = {
					50 = { add_trait = honest }
					50 = { add_trait = just }
				}
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = honest }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = just }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			25 = {
				change_diplomacy = 1
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 10 }
				}
			}
			15 = {
				change_diplomacy = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
			10 = {
				random_list = {
					50 = { add_trait = deceitful }
					50 = { add_trait = arbitrary }
				}
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = deceitful }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = arbitrary }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
		}
    }
	option = { 
        name = EVTOPTD_equus.261 #Party Performance
		random_list = {
			15 = {
				random_list = {
					50 = { add_trait = hedonist }
					50 = { add_trait = gamer }
				}
				set_character_flag = training_success2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = hedonist }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = gamer }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 25 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			25 = {
				change_diplomacy = 1
				set_character_flag = training_success1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = diligent }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = patient }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = content }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 20 }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 15 }
				}
			}
			35 = {
				set_character_flag = training_failure0
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					FROMFROM = { diplomacy = 10 }
				}
			}
			15 = {
				change_diplomacy = -1
				set_character_flag = training_failure1
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
			10 = {
				random_list = {
					66 = { add_trait = slothful }
					33 = { add_trait = lustful }
				}
				set_character_flag = training_failure2
				modifier = {
					factor = 1.33
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = wroth }
				}
				modifier = {
					factor = 1.33
					FROMFROM = { trait = ambitious }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = lustful }
				}
				modifier = {
					factor = 2
					FROMFROM = { trait = slothful }
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 15 }}
				}
				modifier = {
					factor = 1.33
					NOT = { FROMFROM = { diplomacy = 10 }}
				}
			}
		}
    }
}

#Training resolution
character_event = {
    id = equus.262
    desc = {
		trigger = {
			OR = {
				has_character_flag = training_success2 #Success
				has_character_flag = training_success1
			}
		}
		text = EVTDESC_equus.262s
	}
	desc = {
		trigger = {
			has_character_flag = training_failure0 #Neutral
		}
		text = EVTDESC_equus.262n
	}
	desc = {
		trigger = {
			OR = { 
				has_character_flag = training_failure2 #Failure
				has_character_flag = training_failure1
			}
		}
		text = EVTDESC_equus.262f
	}
    picture = "GFX_evt_dancing"
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_equus.262 #Success
		trigger = {
			OR = {
				has_character_flag = training_success2 
				has_character_flag = training_success1
			}
		}
		clr_quest = diplomatic_knights_quest_training #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
		change_society_currency = 100
		event_target:quest_collaborator = {
			opinion = {
				modifier = opinion_mutual_respect
				who = ROOT
				years = 5
			}
		}
		opinion = {
			modifier = opinion_mutual_respect
			who = event_target:quest_collaborator
			years = 5
		}
    }
	option = { 
        name = EVTOPTB_equus.262 #Neutral
		trigger = {
			has_character_flag = training_failure0
		}
		clr_quest = diplomatic_knights_quest_training #remove the quest
		add_mission_succeed_influence_effect = yes #quest add society influence
    }
	option = {
        name = EVTOPTC_equus.262 #Failure
		trigger = {
			OR = { 
				has_character_flag = training_failure2 
				has_character_flag = training_failure1
			}
		}
		clr_quest = diplomatic_knights_quest_training #remove the quest
		add_mission_fail_succeed_effect = yes #quest remove society influence
		change_society_currency = -100 
		event_target:quest_collaborator = {
			opinion = {
				modifier = opinion_unimpressed
				who = ROOT
				years = 5
			}
		}
		opinion = {
			modifier = opinion_unimpressed
			who = event_target:quest_collaborator
			years = 5
		}
    }
}